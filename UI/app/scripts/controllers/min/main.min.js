"use strict";angular.module("uavRcApp").controller("MainCtrl",function(t,e){var o=L.map("map").setView([48.084730529496646,11.279869079589842],17);L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(o),o.on("click",function(o){if(t.cmdGoto){var a={latitude:o.latlng.lat,longitude:o.latlng.lng,height:20};e.emit("COMMAND_GOTO",a)}});var a=new L.FeatureGroup;o.addLayer(a);var n=new L.Control.Draw({draw:{polyline:{shapeOptions:{color:"#f357a1",weight:10}},polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},circle:!1,rectangle:!1,marker:{}},edit:{featureGroup:a}});o.addControl(n);var r;o.on("draw:created",function(t){var e=t.layerType,o=t.layer;if("polyline"===e){{({autostart:!0,latlngs:o.getLatLngs()})}r=o.getLatLngs(),g=0}a.addLayer(o)});var l=L.divIcon({iconSize:[70,70],className:"uav"}),i=L.marker([48.084730529496646,11.279869079589842],{draggable:!0,icon:l}).addTo(o).on("dragend",function(){var t={GPS_DATA:{latitude:i._latlng.lat,longitude:i._latlng.lng,height:0}};e.emit("_SET",t)}),d=document.getElementById("falcon");i._icon.appendChild(d),e.forward("GPS_DATA",t),e.forward("connect",t),e.forward("debug",t),t.goto={latitude:0,longitude:1e-4,height:50};var g=0;t.send=function(){e.emit("COMMAND_GOTO",t.goto)},t.$on("socket:connect",function(){var t={GPS_DATA:{latitude:48.084730529496646,longitude:11.279869079589842,height:0}};e.emit("_SET",t),e.emit("test"),e.emit("test")}),t.$on("socket:GPS_DATA",function(t,e){console.log(e);var o=L.latLng(e.latitude,e.longitude);i.setLatLng(o),d.style["-webkit-transform"]="rotate("+(180+e.heading)%360+"deg)"}),t.$on("socket:debug",function(t,e,o){console.log(e,o)})});